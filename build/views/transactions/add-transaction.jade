extends ../layout

block append stylesheet
    link(rel='stylesheet', href='/stylesheets/transactions.css')

block content
    .row
        .col-xs-12
            h1 Add Transaction
            //If there is some kind of error, display something went wrong
        if(message)
            .col-md-10.col-md-offset-1.col-xs-12
                div#errorMessage.alert.danger.alert-danger(role='alert')
                    .alert-title
                        i.fa.fa-check.fa-2x
                        strong Something went wrong!
                    p !{message}

    .col-md-10.col-md-offset-1.col-xs-12
        form.form-horizontal(method='post', role='form')
            .form-group
                .col-sm-10.col-sm-offset-1
                    span Transaction for &nbsp
                        select(required id='employeeDropdown' name='employeeDropdown')
                            option(disabled selected value='0') Select Employee
                            //Code gets every user in the employee table of the database for the select employee drop down
                            each user, i in users
                                if employee != undefined && employee == user.t_number
                                    option(value='#{user.t_number}' selected) #{user.first_name} #{user.last_name}
                                else if selectedEmployee != undefined && selectedEmployee == user.t_number
                                    option(value='#{user.t_number}' selected) #{user.first_name} #{user.last_name}
                                else
                                    option(value='#{user.t_number}') #{user.first_name} #{user.last_name}

            //Show only this field on start
            .form-group
                .col-sm-10.col-sm-offset-1
                    span Transaction Type &nbsp
                        select(required id='transactionDropdown' name='transactionDropdown')
                            option(disabled selected value='0') Select Transaction Type
                            each transaction, t in transactions
                                option(value='#{transaction.transaction_type_id}') #{transaction.transaction_types}

            hr

            //Show only if transaction type is device
            .device-group
                .single-device
                    .form-group
                        .col-sm-10.col-sm-offset-1
                            span Activation Type &nbsp
                                select(required id='activationDropdown' name='activationDropdown')
                                    option(disabled selected value='0') Select Activation Type
                                    each activation, a in activations
                                        option(value='#{activation.activation_type_id}') #{activation.activation_types}
                            input(type='checkbox', name="sbsActivation" checked=false)
                            | SBS Activation?


                    //Show only if transaction type is device
                    .form-group
                        .col-sm-10.col-sm-offset-1
                            span Device Type &nbsp
                                select(required id='deviceDropdown' name='deviceDropdown')
                                    option(disabled selected value='0') Select Device Type
                                    each device, d in devices
                                        option(value='#{device.device_type_id}') #{device.device_types}

                    //Show only if transaction type is device
                    .form-group
                        .col-sm-10.col-sm-offset-1
                            span Warranty Type &nbsp
                                select(required id='warrantyDropdown' name='warrantyDropdown')
                                    option(disabled selected value='0') Select Warranty Type
                                    each warranty, w in warrantys
                                        option(value='#{warranty.warranty_type_id}') #{warranty.warranty_types}

                    //Show only on all transaction types, but Accessory
                    .form-group
                        .col-sm-10.col-sm-offset-1
                            span Attached? &nbsp
                                select(required id='attached' name='attachedDropdown')
                                    option(selected value='no') No
                                    option(value='yes') Yes

                    //Show on all transaction types
                    .form-group
                        .col-sm-5.col-sm-offset-1.plus-minus-group
                            .input-group
                                | Number of Accessories
                                span.input-group-btn
                                    button.btn.btn-danger.btn-number(type='button', data-type='minus', data-field='accessoryCount')
                                        span.glyphicon.glyphicon-minus
                                input.form-control.input-number(type='number', name='accessoryCount', value='0', min='0', max='100')
                                span.input-group-btn
                                    button.btn.btn-success.btn-number(type='button', data-type='plus', data-field='accessoryCount')
                                        span.glyphicon.glyphicon-plus


            .form-group.text-center
                .col-lg-2
                    button#addDevice.form-btn.btn.btn-lg.btn-primary.btn-block(name='addDevice', type='button', onclick='addDevices()') Add Device

            hr

            //Show on all transaction types
            .form-group
                .col-sm-10.col-sm-offset-1
                    input.form-control.formInput(name='revenueText', placeholder='Revenue', type='number')

            hr

            //Learning Sessions & AOTM
            .form-group
                .col-sm-5.col-sm-offset-1.plus-minus-group
                    .input-group
                        | Learning Sessions
                        span.input-group-btn
                            button.btn.btn-danger.btn-number(type='button', data-type='minus', data-field='learningSessionsCount')
                                span.glyphicon.glyphicon-minus
                        input.form-control.input-number(id="1" type='number', name='learningSessionsCount', value='0', min='0', max='100')
                        span.input-group-btn
                            button.btn.btn-success.btn-number(type='button', data-type='plus', data-field='learningSessionsCount')
                                span.glyphicon.glyphicon-plus
                .col-sm-5.col-sm-offset-1.plus-minus-group
                    .input-group
                        | AOTM
                        span.input-group-btn
                            button.btn.btn-danger.btn-number(type='button', data-type='minus', data-field='aotmCount')
                                span.glyphicon.glyphicon-minus
                        input.form-control.input-number(id="2"  type='number', name='aotmCount', value='0', min='0', max='100')
                        span.input-group-btn
                            button.btn.btn-success.btn-number(type='button', data-type='plus', data-field='aotmCount')
                                span.glyphicon.glyphicon-plus

            // Credit Card Applications & Critters
            .form-group
                .col-sm-5.col-sm-offset-1.plus-minus-group
                    .input-group
                        | Credit Card Applications
                        span.input-group-btn
                            button.btn.btn-danger.btn-number(type='button', data-type='minus', data-field='creditCardCount')
                                span.glyphicon.glyphicon-minus
                        input.form-control.input-number(id="6"  type='number', name='creditCardCount', value='0', min='0', max='100')
                        span.input-group-btn
                            button.btn.btn-success.btn-number(type='button', data-type='plus', data-field='creditCardCount')
                                span.glyphicon.glyphicon-plus
                .col-sm-5.col-sm-offset-1.plus-minus-group
                    .input-group
                        | Critters
                        span.input-group-btn
                            button.btn.btn-danger.btn-number(type='button', data-type='minus', data-field='critterCount')
                                span.glyphicon.glyphicon-minus
                        input.form-control.input-number(id="4"  type='number', name='critterCount', value='0', min='0', max='100')
                        span.input-group-btn
                            button.btn.btn-success.btn-number(type='button', data-type='plus', data-field='critterCount')
                                span.glyphicon.glyphicon-plus

            // Appointments & Donations
            .form-group
                .col-sm-5.col-sm-offset-1.plus-minus-group
                    .input-group
                        | Appointments
                        span.input-group-btn
                            button.btn.btn-danger.btn-number(type='button', data-type='minus', data-field='appointmentsCount')
                                span.glyphicon.glyphicon-minus
                        input.form-control.input-number(id="3"  type='number', name='appointmentsCount', value='0', min='0', max='100')
                        span.input-group-btn
                            button.btn.btn-success.btn-number(type='button', data-type='plus', data-field='appointmentsCount')
                                span.glyphicon.glyphicon-plus
                .col-sm-5.col-sm-offset-1.plus-minus-group
                    .input-group
                        | Donations
                        span.input-group-btn
                            button.btn.btn-danger.btn-number(type='button', data-type='minus', data-field='donationsCount')
                                span.glyphicon.glyphicon-minus
                        input.form-control.input-number(id="5"  type='number', name='donationsCount', value='0', min='0', max='100')
                        span.input-group-btn
                            button.btn.btn-success.btn-number(type='button', data-type='plus', data-field='donationsCount')
                                span.glyphicon.glyphicon-plus
            //Buttons
            .form-group.text-center
                .col-lg-4.col-lg-offset-4
                    button#saveAndNew.form-btn.btn.btn-lg.btn-success.btn-block(name='saveTransaction', type='button') Save & Start New Transaction
            .form-group.text-center
                .col-lg-2.col-lg-offset-4
                    button#cancelTransaction.form-btn.btn.btn-lg.btn-danger.btn-block(name='cancelTransaction', type='button') Cancel
                .col-lg-2
                    button#saveTransaction.form-btn.btn.btn-lg.btn-success.btn-block(name='saveTransaction', type='submit') Save

block append script
    script(src='/javascripts/transactions.js')

