{"version":3,"sources":["user.es6"],"names":[],"mappings":"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","file":"user.js","sourcesContent":["/**\n * Created by michael on 07/05/16.\n */\nvar connection = require('../connection');\n\nexports.create = function(user, done) {\n    connection.get().query('INSERT INTO `users` SET ?', [user], function(error, result) {\n        if(error) {\n            return done(error);\n        }\n\n        //TODO: add auto-increment id in users table for result.insertId\n        done(null, null);\n    });\n};\n\nexports.deleteById = function(id, done) {\n    connection.get().query('DELETE FROM `users` WHERE `t_number` = ?', id, function(error, result) {\n        if(error) {\n            return done(error);\n        }\n\n        done(null, result.affectedRows);\n    });\n};\n\nexports.deleteByIds = function(ids, done) {\n    connection.get().query('DELETE FROM `users` WHERE `t_number` IN (?)', [ids], function(error, result) {\n        if(error) {\n            return done(error);\n        }\n\n        done(null, result.affectedRows);\n    });\n};\n\n/*\n    TODO: make export function for users update query\n    UPDATE users ' +\n    'INNER JOIN tokens ON users.t_number = tokens.t_number' +\n    ' SET users.password = ?' +\n    ' WHERE tokens.token = ?\n */\nexports.update = function(joins, columns, conditions, values) {\n    var queryParams = [];\n    if(joins) {\n        queryParams.push(joins.join(' '));\n    }\n    queryParams.push(columns, conditions);\n    var query = connection.get().format(\n                'UPDATE `users` ' + joins ? '? ' : '' +\n                'SET ? ' +\n                'WHERE ? ',\n                queryParams);\n\n    console.log(query);\n    return;\n    connection.get().query(query, [values], function(error, result) {\n        if(error) {\n            return done(error);\n        }\n\n        done(null, result.changedRows);\n    });\n};\n\nexports.exists = function(username, done) {\n    connection.get().query('SELECT `username` FROM `users` WHERE `username` = ?', username, function(error, result) {\n        if(error) {\n            return done(error);\n        }\n\n        done(null, result);\n    });\n};\n\nexports.emailExists = function(email, done) {\n    connection.get().query('SELECT `email` FROM `users` WHERE `email` = ?', email, function(error, result) {\n        if(error) {\n            return done(error);\n        }\n\n        done(null, result);\n    });\n};\n\nexports.getById = function(id, done) {\n    connection.get().query('SELECT * FROM `users` WHERE `t_number` = ?', id, function(error, result) {\n        if(error) {\n            return done(error);\n        }\n\n        done(null, result);\n    });\n};\n\nexports.getByName = function(username, done) {\n    connection.get().query('SELECT * FROM `users` WHERE `username` = ?', username, function(error, result) {\n        if(error) {\n            return done(error);\n        }\n\n        done(null, result);\n    });\n};\n\nexports.getStoreByTNum = function(t_number, done) {\n    connection.get().query('SELECT `store_id` FROM `users` WHERE `t_number` = ?', t_number, function(error, result) {\n        if(error) {\n            return done(error);\n        }\n\n        done(null, result);\n    });\n};\n\nexports.getAllUsersByStoreID = function(id, done) {\n    connection.get().query('SELECT * FROM users INNER JOIN stores_util on users.t_number = stores_util.t_number WHERE stores_util.store_id = ? GROUP BY users.t_number', id, function(error, result) {\n        if(error) {\n            return done(error);\n        }\n\n        done(null, result);\n    });\n};\n\nexports.getAllUsersByStoreIds = function(ids, done) {\n    connection.get().query('SELECT * FROM users INNER JOIN stores_util on users.t_number = stores_util.t_number WHERE stores_util.store_id in (?) GROUP BY users.t_number', [ids], function(error, result) {\n        if(error) {\n            return done(error);\n        }\n\n        done(null, result);\n    });\n};\n\nexports.getAll = function(done) {\n    connection.get().query('SELECT * FROM `users`', function(error, result) {\n        if(error) {\n            return done(error);\n        }\n\n        done(null, result);\n    });\n};\n\n\n\n"]}