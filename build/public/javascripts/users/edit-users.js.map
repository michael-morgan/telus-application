{"version":3,"sources":["edit-users.es6"],"names":[],"mappings":"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","file":"edit-users.js","sourcesContent":["var privileges;\n\nvar tNumberInput, firstNameInput, lastNameInput,\n    emailInput, titleInput;\n\nconst T_NUMBER_INDEX = 0, FIRST_NAME_INDEX = 1, LAST_NAME_INDEX = 2,\n    EMAIL_INDEX = 3, TITLE_INDEX = 4;\n\nvar stores;\n\n// document.ready\n$(() => {\n    tNumberInput = $('#tNumberInput');\n    firstNameInput = $('#firstNameInput');\n    lastNameInput = $('#lastNameInput');\n    emailInput = $('#emailInput');\n    titleInput = $('#titleInput');\n\n    $('#editModal').on('shown.bs.modal', () => {\n        tNumberInput.focus();\n    });\n\n    $('[data-toggle=\"tooltip\"]').tooltip();\n\n    privileges = [{name: 'Employee', value: 1}, {name: 'Assistant Manager', value: 2},\n                {name: 'Manager', value: 3}, {name: 'Area Manager', value: 4}];\n\n    // initialize store object\n    stores = {};\n    usersObj.forEach((user) => {\n        stores[user.t_number] = user.stores;\n    });\n\n    $('#storeSelect').change((event) => {\n        let target = $(event.currentTarget[event.target.selectedIndex]);\n        let name = target[0].text, id = target[0].value;\n\n        addStoreListItem(name, id);\n        $('#storeSelect').val('0');\n    });\n});\n\nfunction addStoreListItem(name, id) {\n    let t_number = tNumberInput.val();\n\n    if(stores[t_number].filter((store) => store.store_id == id).length == 0) {\n        stores[t_number].push({store_id: id});\n        $('#storeList').append(getStoreListItem(name, id));\n    }\n}\n\nfunction getStoreListItem(name, id) {\n    return `\n        <li class=\"list-group-item\" id=\"storeListItem${id}\">\n            <span>${name}</span>\n            <i class=\"fa fa-times-circle fa-2x pull-right\" style=\"margin-top: -2px;\" onclick=\"removeStoreListItem(${id})\"></i>\n        </li>\n    `;\n}\n\nfunction removeStoreListItem(id) {\n    let t_number = tNumberInput.val();\n\n    stores[t_number].splice(stores[t_number].findIndex((store) => store.store_id == id), 1);\n    $(`#storeListItem${id}`).remove();\n}\n\nfunction updateStoreListItems(t_number) {\n    // reset store list\n    $('#storeList').html('');\n\n    let storeSelect = [].slice.call($('#storeSelect')[0].children);\n\n    stores[t_number].forEach((store) => {\n        $('#storeList').append(getStoreListItem(\n            storeSelect[storeSelect.findIndex((selectStore) => selectStore.value == store.store_id)].text,\n            store.store_id\n        ));\n    });\n}\n\nfunction populateEditModal(rowId) {\n    tNumberInput.val($(rowId)[0].children[T_NUMBER_INDEX].textContent);\n    firstNameInput.val($(rowId)[0].children[FIRST_NAME_INDEX].textContent);\n    lastNameInput.val($(rowId)[0].children[LAST_NAME_INDEX].textContent);\n    emailInput.val($(rowId)[0].children[EMAIL_INDEX].textContent);\n    titleInput.val(privileges.find((privilege) => privilege.name == $(rowId)[0].children[TITLE_INDEX].textContent).value);\n\n    updateStoreListItems(tNumberInput.val());\n\n    $('#editModal').modal('show');\n}\n\nfunction updateUser() {\n    $.post(\"/users/edit\", {\n        t_number: tNumberInput.val(),\n        first_name: firstNameInput.val(),\n        last_name: lastNameInput.val(),\n        email: emailInput.val(),\n        title: titleInput.val(),\n        password: $('#passwordInput').val(),\n        stores: JSON.stringify(stores[tNumberInput.val()])\n    }).done(function(result) {\n        let data = JSON.parse(result);\n        populateRow(`#userRow${data.t_number}`, data);\n    });\n}\n\n// possible functionality\nfunction clearEditModal() {}\n\nfunction populateRow(rowId, data) {\n    $(rowId).html(`\n        <td>${data.t_number}</td>\n        <td>${data.first_name}</td>\n        <td>${data.last_name}</td>\n        <td>${data.email}</td>\n        <td>${privileges.find((privilege) => privilege.value == data.title).name}</td>\n        <td>\n            <a class=\"btn btn-primary\" href=\"#\" aria-label=\"Edit\" onclick='populateEditModal(\"#userRow${data.t_number}\")'>\n                <i class=\"fa fa-pencil-square-o\" aria-hidden=\"true\"></i>\n            </a>\n        </td>\n        <td>\n            <input class=\"form-control\" name='remove${data.t_number}' type=\"checkbox\">\n        </td>\n    `);\n}\n\n\nfunction deleteUser() {\n    //Confirmation modal that appears when a user attempts to delete another user from the modify users page\n    bootbox.confirm(\"Are you sure you want to delete this user?\", (result) => {\n        if (result) {\n            //If the user clicks on \"OK\" in the confirmation box\n            document.getElementById(\"listUsersForm\").submit();\n        }\n    });\n}"]}